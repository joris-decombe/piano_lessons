/* 1. Import Pixel Fonts */
@import url('https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400;500;600;700&family=Press+Start+2P&display=swap');

@import "tailwindcss";

/* ============================================
   THEME SYSTEM - 3 Pixel Art Color Themes
   ============================================ */

:root {
  /* Default to cool theme */
  --background: #0a0a0f;
  --foreground: #E2E4E9;
}

/* --- COOL THEME (Cyber/Neon) --- */
:root, [data-theme="cool"] {
  /* Voids & Darks */
  --color-void: #0a0a0f;
  --color-bg: #12121a;
  --color-surface: #1a1a24;
  --color-elevated: #22222e;

  /* Neutrals */
  --color-border: #3a3a4a;
  --color-muted: #5a5a6a;
  --color-subtle: #8a8a9a;
  --color-text: #cacad4;
  --color-text-bright: #eaeaf0;

  /* Piano Keys */
  --color-key-white: #d8dae0;
  --color-key-white-hi: #eaecf0;
  --color-key-white-lo: #a8aab0;
  --color-key-black: #2a2a34;
  --color-key-black-hi: #3a3a44;
  --color-key-black-lo: #1a1a24;

  /* Accents */
  --color-accent-primary: #38bdf8;    /* Cyan */
  --color-accent-secondary: #fb7185;  /* Rose */
  --color-accent-tertiary: #a78bfa;   /* Purple */
  --color-ui-active: #6366f1;         /* Indigo */

  /* Note Colors (Left/Right hands) */
  --color-note-left: #fb7185;
  --color-note-right: #38bdf8;
  --color-note-unified: #a78bfa;
}

/* --- WARM THEME (Vintage/Sepia) --- */
[data-theme="warm"] {
  /* Voids & Darks */
  --color-void: #0f0a06;
  --color-bg: #1a140e;
  --color-surface: #2a2018;
  --color-elevated: #3a2e22;

  /* Neutrals */
  --color-border: #5a4a3a;
  --color-muted: #7a6a5a;
  --color-subtle: #9a8a7a;
  --color-text: #d4c8b8;
  --color-text-bright: #f0e8dc;

  /* Piano Keys - Ivory & Ebony */
  --color-key-white: #f5f0e0;
  --color-key-white-hi: #fffbf0;
  --color-key-white-lo: #c8c0a8;
  --color-key-black: #1a1810;
  --color-key-black-hi: #2a2820;
  --color-key-black-lo: #0a0806;

  /* Accents */
  --color-accent-primary: #f59e0b;    /* Amber */
  --color-accent-secondary: #ef4444;  /* Red */
  --color-accent-tertiary: #d97706;   /* Orange */
  --color-ui-active: #b45309;         /* Amber dark */

  /* Note Colors */
  --color-note-left: #ef4444;
  --color-note-right: #f59e0b;
  --color-note-unified: #fbbf24;
}

/* --- MONO THEME (Terminal/Minimal) --- */
[data-theme="mono"] {
  /* Voids & Darks - Pure blacks */
  --color-void: #000000;
  --color-bg: #0a0a0a;
  --color-surface: #141414;
  --color-elevated: #1e1e1e;

  /* Neutrals - Grayscale */
  --color-border: #333333;
  --color-muted: #555555;
  --color-subtle: #777777;
  --color-text: #aaaaaa;
  --color-text-bright: #dddddd;

  /* Piano Keys - High contrast B&W */
  --color-key-white: #e0e0e0;
  --color-key-white-hi: #f0f0f0;
  --color-key-white-lo: #a0a0a0;
  --color-key-black: #1a1a1a;
  --color-key-black-hi: #2a2a2a;
  --color-key-black-lo: #0a0a0a;

  /* Accents - Phosphor green (like old CRTs) */
  --color-accent-primary: #22c55e;    /* Green */
  --color-accent-secondary: #22c55e;  /* Same green */
  --color-accent-tertiary: #16a34a;   /* Darker green */
  --color-ui-active: #15803d;         /* Even darker */

  /* Note Colors - All green */
  --color-note-left: #4ade80;
  --color-note-right: #22c55e;
  --color-note-unified: #22c55e;
}

/* --- 8-BIT THEME (NES/Mario Bros Era) --- */
[data-theme="8bit"] {
  /* Voids & Darks - NES deep blue-black */
  --color-void: #000000;
  --color-bg: #0c0c28;
  --color-surface: #181850;
  --color-elevated: #282878;

  /* Neutrals - Limited NES palette feel */
  --color-border: #5050a0;
  --color-muted: #7878b8;
  --color-subtle: #9898d0;
  --color-text: #c8c8e8;
  --color-text-bright: #fcfcfc;

  /* Piano Keys - Classic NES white/gray */
  --color-key-white: #fcfcfc;
  --color-key-white-hi: #ffffff;
  --color-key-white-lo: #b8b8b8;
  --color-key-black: #282828;
  --color-key-black-hi: #484848;
  --color-key-black-lo: #080808;

  /* Accents - Mario Bros palette */
  --color-accent-primary: #e52521;    /* Mario Red */
  --color-accent-secondary: #049cd8;  /* Mario Blue */
  --color-accent-tertiary: #fbd000;   /* Coin Gold */
  --color-ui-active: #0068b8;         /* Mario Blue Dark */

  /* Note Colors - NES primaries */
  --color-note-left: #e52521;         /* Red */
  --color-note-right: #049cd8;        /* Blue */
  --color-note-unified: #fbd000;      /* Gold */
}

/* --- 16-BIT THEME (SNES/Street Fighter Era) --- */
[data-theme="16bit"] {
  /* Voids & Darks - SF2 character select deep blue */
  --color-void: #0a0818;
  --color-bg: #101028;
  --color-surface: #181840;
  --color-elevated: #282860;

  /* Neutrals - Richer 16-bit tones */
  --color-border: #4848a0;
  --color-muted: #6868c0;
  --color-subtle: #9090d8;
  --color-text: #c0c0e8;
  --color-text-bright: #f0f0ff;

  /* Piano Keys - SNES quality whites */
  --color-key-white: #f0f0f8;
  --color-key-white-hi: #ffffff;
  --color-key-white-lo: #b0b0c0;
  --color-key-black: #202030;
  --color-key-black-hi: #383848;
  --color-key-black-lo: #101018;

  /* Accents - Street Fighter palette */
  --color-accent-primary: #f08030;    /* Ryu headband orange */
  --color-accent-secondary: #e03020;  /* Ken red */
  --color-accent-tertiary: #30a0f0;   /* Chun-Li blue */
  --color-ui-active: #d06020;         /* Deep orange */

  /* Note Colors - 16-bit fighting game energy */
  --color-note-left: #e03020;         /* Fireball red */
  --color-note-right: #30a0f0;        /* Hadouken blue */
  --color-note-unified: #f08030;      /* Energy orange */
}

/* --- HI-BIT THEME (Modern Indie Pixel Art) --- */
[data-theme="hibit"] {
  /* Voids & Darks - Celeste/HLD inspired deep purple */
  --color-void: #0d0b1a;
  --color-bg: #16132d;
  --color-surface: #1f1b3d;
  --color-elevated: #2a2550;

  /* Neutrals - Soft lavender tones */
  --color-border: #4a4270;
  --color-muted: #6a6290;
  --color-subtle: #9088b0;
  --color-text: #c8c0e0;
  --color-text-bright: #f0ecff;

  /* Piano Keys - Subtle warm whites */
  --color-key-white: #ebe8f0;
  --color-key-white-hi: #f8f6ff;
  --color-key-white-lo: #b0a8c0;
  --color-key-black: #1a1828;
  --color-key-black-hi: #2a2840;
  --color-key-black-lo: #0a0810;

  /* Accents - Modern indie palette (Celeste pinks/cyans) */
  --color-accent-primary: #ff6188;    /* Hot pink */
  --color-accent-secondary: #78dce8;  /* Cyan */
  --color-accent-tertiary: #ab9df2;   /* Lavender */
  --color-ui-active: #fc9867;         /* Warm peach */

  /* Note Colors - Vibrant modern */
  --color-note-left: #ff6188;         /* Pink */
  --color-note-right: #78dce8;        /* Cyan */
  --color-note-unified: #ab9df2;      /* Lavender */
}

/* stylelint-disable-next-line at-rule-no-unknown */
@theme inline {
  --color-background: var(--color-void);
  --color-foreground: var(--color-text);
  --font-sans: "Pixelify Sans", system-ui, sans-serif;
  --font-mono: "Pixelify Sans", monospace;
  --font-display: "Press Start 2P", monospace;

  /* --- Semantic Mappings (use theme vars) --- */
  --color-piano-void: var(--color-void);
  --color-piano-bg: var(--color-bg);
  --color-piano-frame-dark: var(--color-void);
  --color-piano-frame-light: var(--color-surface);

  --color-piano-black-bed: var(--color-key-black-lo);
  --color-piano-black-face: var(--color-key-black);
  --color-piano-black-highlight: var(--color-key-black-hi);

  --color-piano-white-surface: var(--color-key-white);
  --color-piano-white-pressed: var(--color-key-white-lo);
  --color-piano-white-shadow: var(--color-key-white-lo);
  --color-piano-white-highlight: var(--color-key-white-hi);

  /* --- Spacing --- */
  --spacing-key-w: 24px;
  --spacing-key-h: 150px;
  --spacing-black-w: 14px;
  --spacing-black-h: 96px;

  /* --- Pixel Art Shadows --- */

  /* Raised button/panel bevel (light top-left, dark bottom-right) */
  --shadow-bevel-raised:
    inset 2px 2px 0 0 var(--color-key-white-hi),
    inset -2px -2px 0 0 var(--color-border);

  /* Pressed/inset bevel */
  --shadow-bevel-pressed:
    inset 2px 2px 0 0 var(--color-border),
    inset -2px -2px 0 0 var(--color-key-white-hi);

  /* Note blocks (Tetris style) */
  --shadow-bevel-note:
    inset 1px 1px 0 0 rgba(255, 255, 255, 0.9),
    inset 2px 2px 0 0 rgba(255, 255, 255, 0.4),
    inset -1px -1px 0 0 rgba(0, 0, 0, 0.6),
    inset -2px -2px 0 0 rgba(0, 0, 0, 0.3);

  /* Active key overlay bevel */
  --shadow-bevel-active:
    inset 2px 2px 0 0 rgba(255, 255, 255, 0.4),
    inset -2px -2px 0 0 rgba(0, 0, 0, 0.2);

  /* White key neighbor shadows (when pressed) */
  --shadow-key-left: inset 2px 0 0 0 var(--color-key-white-lo);
  --shadow-key-right: inset -2px 0 0 0 var(--color-key-white-lo);

  /* Hard shadow for separators */
  --shadow-hard: 1px 0 0 0 var(--color-border);
  --shadow-hard-inset: inset 0 -1px 0 0 var(--color-border);

  /* Animations */
  --ease-pixel: cubic-bezier(0, 0, 0, 1);
}

@keyframes scroll {
  from { background-position: 0 0; }
  to { background-position: 0 16px; } /* Matches background-size 16px for seamless loop */
}

.animate-scroll {
  animation: scroll 0.5s linear infinite;
}

body {
  background: var(--color-void);
  color: var(--color-text);
  font-family: var(--font-sans);
  -webkit-font-smoothing: none;
  -moz-osx-font-smoothing: grayscale;
  image-rendering: pixelated;
  overscroll-behavior: none;
}

/* Scrollbar Hiding */
.no-scrollbar::-webkit-scrollbar { display: none; }
.no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

/* ============================================
   PIXEL ART UI COMPONENTS
   ============================================ */

/* Raised panel (like Windows 95 buttons) */
.pixel-panel {
  background: var(--color-surface);
  border: 2px solid var(--color-border);
  box-shadow:
    inset 1px 1px 0 0 var(--color-elevated),
    inset -1px -1px 0 0 var(--color-void);
}

/* Raised button */
.pixel-btn {
  background: var(--color-surface);
  border: 2px solid transparent;
  box-shadow:
    inset 1px 1px 0 0 var(--color-text),
    inset -1px -1px 0 0 var(--color-void),
    1px 1px 0 0 var(--color-void);
  transition: none;
}

.pixel-btn:hover {
  background: var(--color-elevated);
}

.pixel-btn:active {
  box-shadow:
    inset 1px 1px 0 0 var(--color-void),
    inset -1px -1px 0 0 var(--color-text);
}

/* Primary action button (colored) */
.pixel-btn-primary {
  background: var(--color-ui-active);
  color: var(--color-text-bright);
  border: 2px solid transparent;
  box-shadow:
    inset 1px 1px 0 0 var(--color-accent-primary),
    inset -1px -1px 0 0 var(--color-void),
    1px 1px 0 0 var(--color-void);
}

.pixel-btn-primary:hover {
  filter: brightness(1.1);
}

.pixel-btn-primary:active {
  box-shadow:
    inset 1px 1px 0 0 var(--color-void),
    inset -1px -1px 0 0 var(--color-accent-primary);
}

/* Inset/pressed area */
.pixel-inset {
  background: var(--color-void);
  border: 2px solid transparent;
  box-shadow:
    inset 1px 1px 0 0 var(--color-border),
    inset -1px -1px 0 0 var(--color-elevated);
}

/* Divider line */
.pixel-divider {
  height: 2px;
  background: linear-gradient(to bottom, var(--color-border) 50%, var(--color-elevated) 50%);
}

/* Text styles */
.pixel-text-muted { color: var(--color-muted); }
.pixel-text-subtle { color: var(--color-subtle); }
.pixel-text-accent { color: var(--color-accent-primary); }

/* Display font for titles */
.pixel-title {
  font-family: "Press Start 2P", monospace;
  letter-spacing: 1px;
  line-height: 1.4;
}

/* ============================================
   THEME TRANSITIONS & EFFECTS
   ============================================ */

/* Smooth theme transitions */
body {
  transition: background-color 300ms ease, color 300ms ease;
}

.pixel-panel,
.pixel-btn,
.pixel-btn-primary,
.pixel-inset {
  transition: background-color 300ms ease, box-shadow 300ms ease;
}

/* Enhanced button hover - satisfying "pop" */
.pixel-btn:hover {
  background: var(--color-elevated);
  transform: translate(-1px, -1px);
  box-shadow:
    inset 1px 1px 0 0 var(--color-text),
    inset -1px -1px 0 0 var(--color-void),
    2px 2px 0 0 var(--color-void);
}

.pixel-btn:active {
  transform: translate(0, 0);
  box-shadow:
    inset 1px 1px 0 0 var(--color-void),
    inset -1px -1px 0 0 var(--color-text);
}

/* ============================================
   CRT / RETRO EFFECTS
   ============================================ */

/* Scanlines for retro themes */
[data-theme="8bit"] .crt-effect::after,
[data-theme="16bit"] .crt-effect::after,
[data-theme="mono"] .crt-effect::after {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  background: repeating-linear-gradient(
    0deg,
    rgba(0, 0, 0, 0.03) 0px,
    rgba(0, 0, 0, 0.03) 1px,
    transparent 1px,
    transparent 2px
  );
  z-index: 9999;
}

/* Phosphor glow for mono/terminal theme */
[data-theme="mono"] .pixel-text-accent,
[data-theme="mono"] .pixel-btn-primary {
  text-shadow: 0 0 8px var(--color-accent-primary);
}

[data-theme="mono"] h1,
[data-theme="mono"] .glow {
  text-shadow:
    0 0 4px var(--color-accent-primary),
    0 0 12px var(--color-accent-primary);
}

/* Subtle noise texture for hi-bit theme */
[data-theme="hibit"] .noise-texture::before {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  opacity: 0.015;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  z-index: 9998;
}

/* ============================================
   THEME COLOR SWATCHES
   ============================================ */

.theme-swatch {
  display: flex;
  gap: 2px;
  margin-bottom: 6px;
}

.theme-swatch > div {
  width: 12px;
  height: 12px;
  border: 1px solid rgba(0, 0, 0, 0.3);
}

/* ============================================
   KEYBOARD SHORTCUT HINTS (kbd)
   ============================================ */

.pixel-kbd {
  display: inline-block;
  padding: 1px 5px;
  font-family: "Pixelify Sans", monospace;
  font-size: 10px;
  line-height: 1.4;
  color: var(--color-text);
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  box-shadow:
    inset 1px 1px 0 0 var(--color-elevated),
    1px 1px 0 0 var(--color-void);
  margin: 0 1px;
}

/* ============================================
   PIXEL ART TOGGLE SWITCH
   ============================================ */

.pixel-toggle {
  position: relative;
  width: 36px;
  height: 20px;
  background: var(--color-void);
  border: 2px solid var(--color-border);
  box-shadow:
    inset 1px 1px 0 0 var(--color-border),
    inset -1px -1px 0 0 var(--color-elevated);
  cursor: pointer;
  flex-shrink: 0;
}

.pixel-toggle-on {
  background: var(--color-ui-active);
  border-color: var(--color-accent-primary);
}

.pixel-toggle-thumb {
  position: absolute;
  top: 2px;
  left: 2px;
  width: 12px;
  height: 12px;
  background: var(--color-muted);
  box-shadow:
    inset 1px 1px 0 0 var(--color-text),
    inset -1px -1px 0 0 var(--color-void);
  transition: transform 0.1s;
}

.pixel-toggle-on .pixel-toggle-thumb {
  transform: translateX(16px);
  background: var(--color-text-bright);
}

/* ============================================
   TOUCH DEVICE IMPROVEMENTS
   ============================================ */

@media (pointer: coarse) {
  /* Larger range input track for touch */
  input[type="range"] {
    min-height: 24px;
  }

  /* Ensure buttons have adequate touch targets */
  .pixel-btn,
  .pixel-btn-primary {
    min-width: 44px;
    min-height: 44px;
  }
}

/* ============================================
   MENU ANIMATIONS
   ============================================ */

/* First-timer recommended card pulse */
@keyframes pulse-border {
  0%, 100% { filter: brightness(1); }
  50% { filter: brightness(1.2); }
}

.pulse-border {
  animation: pulse-border 2s ease-in-out infinite;
}

/* RPG cursor bounce */
@keyframes cursor-bounce {
  0%, 100% { transform: translateX(0); }
  50% { transform: translateX(4px); }
}

.cursor-bounce {
  animation: cursor-bounce 0.6s ease-in-out infinite;
}